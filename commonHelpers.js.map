{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport './css/styles.css';\nimport axios from 'axios';\nconst API_KEY = '42038034-2f13ad7c323f856cf793448ff';\nconst URL = 'https://pixabay.com/api/';\nconst form = document.querySelector('.form-inline');\nconst containerEl = document.querySelector('.card-container');\nconst loadMoreBtn = document.querySelector('.label');\nconst preloader = document.getElementById('preloader');\nconst queryParams = {\n  q: '',\n  page: 1,\n  maxPage: 0,\n  per_page: 40,\n};\nlet currentSearchQuery = '';\nconst hiddenClass = 'is-hidden';\nfunction hide(button) {\n  button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n  button.classList.remove(hiddenClass);\n}\n\nfunction enable(button, preloader) {\n  preloader.classList.add(hiddenClass);\n  button.disabled = false;\n}\n\nfunction disable(button, preloader) {\n  preloader.classList.remove(hiddenClass);\n  button.disabled = true;\n}\nfunction showLoadingIndicator() {\n  containerEl.innerHTML = '<div class=\"loader\"></div>';\n}\nfunction hideLoadingIndicator() {\n  const loadingElement = containerEl.querySelector('.loader');\n  if (loadingElement) {\n    loadingElement.remove();\n  }\n}\nform.addEventListener('submit', handleSearch);\nasync function handleSearch(event) {\n  event.preventDefault();\n  containerEl.innerHTML = '';\n  const form = event.currentTarget;\n  const picture = form.elements.picture.value.trim();\n  currentSearchQuery = picture;\n  queryParams.page = 1;\n  if (picture === '' || picture == null) {\n    iziToast.error({\n      title: 'Error',\n      message: `❌Sorry, there are no images matching your search query. Please, try again!`,\n    });\n    containerEl.innerHTML = '';\n    hide(loadMoreBtn);\n    return;\n  }\n  showLoadingIndicator();\n  try {\n    const { hits, totalHits } = await serchPicture(picture);\n    if (hits && hits.length > 0) {\n      queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n      createPictureMarkup(hits, containerEl);\n      const lightbox = new SimpleLightbox('.card-container a', {\n        captionsData: 'alt',\n        captionPosition: 'bottom',\n        captionDelay: 250,\n      });\n      lightbox.refresh();\n      if (hits && hits.length > 0 && hits.length !== totalHits) {\n        show(loadMoreBtn);\n        loadMoreBtn.removeEventListener('click', handleLoadMore);\n        loadMoreBtn.addEventListener('click', handleLoadMore);\n      } else {\n        hide(loadMoreBtn);\n      }\n    } else {\n      containerEl.innerHTML = '';\n      iziToast.error({\n        title: 'Error',\n        message: `❌Sorry, there are no images matching your search query. Please, try again!`,\n      });\n      hide(loadMoreBtn);\n    }\n  } catch (err) {\n    console.log(err);\n  } finally {\n    hideLoadingIndicator();\n    form.reset();\n  }\n}\nfunction serchPicture(picture, page = 1) {\n  return axios\n    .get(URL, {\n      params: {\n        key: API_KEY,\n        q: picture,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n        page,\n      },\n    })\n    .then(res => {\n      return res.data;\n    });\n}\nasync function handleLoadMore() {\n  queryParams.page += 1;\n  disable(loadMoreBtn, preloader);\n  try {\n    const { hits } = await serchPicture(currentSearchQuery, queryParams.page);\n    createPictureMarkup(hits, containerEl);\n    const cardHeight = containerEl\n      .querySelector('.picture-link')\n      .getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 3, behavior: 'smooth' });\n    const lightbox = new SimpleLightbox('.card-container a', {\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n  } catch (err) {\n    console.log(err);\n  } finally {\n    enable(loadMoreBtn, preloader);\n    if (queryParams.page >= queryParams.maxPage) {\n      hide(loadMoreBtn);\n      iziToast.error({\n        title: 'Error',\n        message: `\"We're sorry, but you've reached the end of search results.\"`,\n      });\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n    } else {\n      show(loadMoreBtn);\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    }\n  }\n}\nfunction createPictureMarkup(hits, containerEl) {\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        likes,\n        views,\n        comments,\n        downloads,\n        largeImageURL,\n      }) => `<a href=\"${largeImageURL}\" class= \"picture-link\">\n    <img src = \"${webformatURL}\">\n    <div class= \"picture-content\">\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Likes</span>\n            <span class= \"picture-sub-title\">${likes}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Views</span>\n            <span class= \"picture-sub-title\">${views}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Comments</span>\n            <span class= \"picture-sub-title\">${comments}</span>\n        </div>\n        <div class= \"picture-text\">\n            <span class= \"picture-title\">Downloads</span>\n            <span class= \"picture-sub-title\">${downloads}</span>\n        </div>\n    </div>\n</a>`\n    )\n    .join();\n  containerEl.insertAdjacentHTML('beforeend', markup);\n}\n//\n"],"names":["API_KEY","URL","form","containerEl","loadMoreBtn","preloader","queryParams","currentSearchQuery","hiddenClass","hide","button","show","enable","disable","showLoadingIndicator","hideLoadingIndicator","loadingElement","handleSearch","event","picture","iziToast","hits","totalHits","serchPicture","createPictureMarkup","SimpleLightbox","handleLoadMore","err","page","axios","res","cardHeight","markup","webformatURL","likes","views","comments","downloads","largeImageURL"],"mappings":"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"}